### puntaje_sisben_3: variable continua
# Controles:
### per001: Sexo, 0: Mujer, 1: Hombre
### per010: Embarazada, 0: No, 1: Sí
### per016: Percibe ingresos: 0: No, 1: Sí
#---- Estimaciones adicionales ----
# Base de datos general
general = sisben3 %>%
relocate(llave, hogar, orden, fex, .before = depto) %>%
relocate(zona, .before = area) %>%
relocate(corte, .before = puntaje_sisben_3) %>%
filter(per002 == 2 | per002 == 3) %>%                   # per002: Edad: 2: 6 a 11 años, 3: 12 a 17 años
mutate(asiste_centro_educativo = ifelse(per011 == 2, 0, 1),
sexo = ifelse(per001 == 2, 0, 1),
paga_alimentax = ifelse(per008 == 2, 0, 1),
embarazada = ifelse(per010 == 2, 0, 1),
percibe_ing = ifelse(per016 == 2, 0, 1),
estudio_ult_mes = ifelse(per014 == 4, 1, 0)
) %>%
select(llave, depto, puntaje_sisben_3, per002, sexo, paga_alimentax, embarazada,
asiste_centro_educativo, percibe_ing, estudio_ult_mes)
#---- Estimax grupo1: 6 a 11 años ----
# Base de datos grupo 1
g1 =  general %>%
filter(per002 == 2)
#---- Estimax grupo2: 12 a 17 años ----
# Base de datos grupo 2
g2 =  general %>%
filter(per002 == 3)
#---- Estimax sin bogota ----
sin_bogota = general %>%
filter(! depto == 11) %>%
#---- Estimax solo bogota ----
solo_bogota = general %>%
filter(depto == 11)
#---- Estimax solo antioquia ----
antioquia = general %>%
filter(depto == 5)
####
### Script con estimaciones adicionales ###
####
# Bibliotecas generales de R
library(tidyverse)   # Conjunto de paquetes (contiene dplyr y ggplot2)
library(readxl)      # Importar bases de datos tipo excel
library(haven)       # Importar bases de datos tipo stata
# RD Packages (Conjunto de paquetes para realizar RDDs creados por Cattaneo)
library(rdrobust)
library(rddensity)
library(lpdensity)
library(rdlocrand)
setwd("~/Documents/GitHub/semestre5_git/proyecto_metodologia_2/trabajo_empirico/bases_de_datos/bases_de_datos_SISBEN")
#---- Indicaciones/información estimación ----
###
# Fucniones para la estimación por medio de un RDD
## rdrobust: Estimación
## rdplot: Gráficas
##
###
# Información sobre la regresión
####
# Variables:
####
# Outcome:
### per014: Actividad en el último mes (que se reescribio para que quedará estudio o no el último mes)
### Variable binaria: 0: el último mes no estudio, 1: el último mes estudio
### Tiene sentido en la medida que los grupos considerados tienen edades entre 6 a 17 años de edad
# Running variable:
### puntaje_sisben_3: variable continua
# Controles:
### per001: Sexo, 0: Mujer, 1: Hombre
### per010: Embarazada, 0: No, 1: Sí
### per016: Percibe ingresos: 0: No, 1: Sí
#---- Estimaciones adicionales ----
# Base de datos general
general = sisben3 %>%
relocate(llave, hogar, orden, fex, .before = depto) %>%
relocate(zona, .before = area) %>%
relocate(corte, .before = puntaje_sisben_3) %>%
filter(per002 == 2 | per002 == 3) %>%                   # per002: Edad: 2: 6 a 11 años, 3: 12 a 17 años
mutate(asiste_centro_educativo = ifelse(per011 == 2, 0, 1),
sexo = ifelse(per001 == 2, 0, 1),
paga_alimentax = ifelse(per008 == 2, 0, 1),
embarazada = ifelse(per010 == 2, 0, 1),
percibe_ing = ifelse(per016 == 2, 0, 1),
estudio_ult_mes = ifelse(per014 == 4, 1, 0)
) %>%
select(llave, depto, puntaje_sisben_3, per002, sexo, paga_alimentax, embarazada,
asiste_centro_educativo, percibe_ing, estudio_ult_mes)
#---- Estimax grupo1: 6 a 11 años ----
# Base de datos grupo 1
g1 =  general %>%
filter(per002 == 2)
#---- Estimax grupo2: 12 a 17 años ----
# Base de datos grupo 2
g2 =  general %>%
filter(per002 == 3)
#---- Estimax sin bogota ----
sin_bogota = general %>%
filter(! depto == 11)
#---- Estimax solo bogota ----
solo_bogota = general %>%
filter(depto == 11)
#---- Estimax solo antioquia ----
antioquia = general %>%
filter(depto == 5)
####
### Script con estimaciones adicionales ###
####
# Bibliotecas generales de R
library(tidyverse)   # Conjunto de paquetes (contiene dplyr y ggplot2)
library(readxl)      # Importar bases de datos tipo excel
library(haven)       # Importar bases de datos tipo stata
# RD Packages (Conjunto de paquetes para realizar RDDs creados por Cattaneo)
library(rdrobust)
library(rddensity)
library(lpdensity)
library(rdlocrand)
setwd("~/Documents/GitHub/semestre5_git/proyecto_metodologia_2/trabajo_empirico/bases_de_datos/bases_de_datos_SISBEN")
#---- Indicaciones/información estimación ----
###
# Fucniones para la estimación por medio de un RDD
## rdrobust: Estimación
## rdplot: Gráficas
##
###
# Información sobre la regresión
####
# Variables:
####
# Outcome:
### per014: Actividad en el último mes (que se reescribio para que quedará estudio o no el último mes)
### Variable binaria: 0: el último mes no estudio, 1: el último mes estudio
### Tiene sentido en la medida que los grupos considerados tienen edades entre 6 a 17 años de edad
# Running variable:
### puntaje_sisben_3: variable continua
# Controles:
### per001: Sexo, 0: Mujer, 1: Hombre
### per010: Embarazada, 0: No, 1: Sí
### per016: Percibe ingresos: 0: No, 1: Sí
#---- Estimaciones adicionales ----
# Base de datos general
general = sisben3 %>%
relocate(llave, hogar, orden, fex, .before = depto) %>%
relocate(zona, .before = area) %>%
relocate(corte, .before = puntaje_sisben_3) %>%
filter(per002 == 2 | per002 == 3) %>%                   # per002: Edad: 2: 6 a 11 años, 3: 12 a 17 años
mutate(asiste_centro_educativo = ifelse(per011 == 2, 0, 1),
sexo = ifelse(per001 == 2, 0, 1),
paga_alimentax = ifelse(per008 == 2, 0, 1),
embarazada = ifelse(per010 == 2, 0, 1),
percibe_ing = ifelse(per016 == 2, 0, 1),
estudio_ult_mes = ifelse(per014 == 4, 1, 0)
) %>%
select(llave, depto, puntaje_sisben_3, per002, sexo, paga_alimentax, embarazada,
asiste_centro_educativo, percibe_ing, estudio_ult_mes)
#---- Estimax grupo1: 6 a 11 años ----
# Base de datos grupo 1
g1 =  general %>%
filter(per002 == 2)
#---- Estimax grupo2: 12 a 17 años ----
# Base de datos grupo 2
g2 =  general %>%
filter(per002 == 3)
#---- Estimax sin bogota ----
sin_bogota = general %>%
filter(! depto == 11)
#---- Estimax solo bogota ----
solo_bogota = general %>%
filter(depto == 11)
#---- Estimax solo antioquia ----
antioquia = general %>%
filter(depto == 5)
mean_sex = mean(general$sexo)
mean_sex = mean(general$percibe_ing)
mean_embaraz = mean(general$embarazada)
mean_percibe_ing = mean(general$percibe_ing)
## Se especifica una matriz de covariadas: sexo, embarazada
covs = cbind.data.frame(general$sexo, general$embarazada, general$percibe_ing)
### estudio en el último mes vs puntaje del sisben (sin covariadas)
estudio_ult_mes_reg = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1); summary(asistencia_centro_educativo_reg)
### asistencia centro educativo vs puntaje del sisben (con covariadas)
estudio_ult_mes_reg_covs = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1, covs = covs); summary(asistencia_centro_educativo_reg_covs)
mean_ult_mes = mean(general$estudio_ult_mes)
mean_ult_mes = mean(general$estudio_ult_mes)
random_inf_treshold = rdrandinf(general$estudio_ult_mes, general$puntaje_sisben_3, cutoff = 30.56,
statistic = "diffmeans", p = 1, kernel = "uniform",
reps = 4000, seed = 1234); summary(random_inf_treshold)
random_inf_treshold = rdrandinf(recidivism, bac, cutoff = 0.08, statistic = "diffmeans", p = 1, kernel = "uniform",
reps = 4000, seed = 1234);summary(random_inf_treshold)
# Bibliotecas generales de R
library(tidyverse)   # Conjunto de paquetes (contiene dplyr y ggplot2)
library(readxl)      # Importar bases de datos tipo excel
library(haven)       # Importar bases de datos tipo stata
# RD Packages (Conjunto de paquetes para realizar RDDs creados por Cattaneo)
library(rdrobust)
library(rddensity)
library(lpdensity)
library(rdlocrand)
setwd("~/Documents/GitHub/semestre5_git/Evaluacion-de-Impacto-/Datos")
# Imporatando la base de datos
base_stata = read_dta("hansen_dwi.dta")  # For reading stata files
base_excel = read_excel("RDD datos.xlsx")
############################################
# Parte II (Reprdoucción empírica del paper)
base = base_stata %>%
mutate(bac = low_score / 1000,
dui = ifelse(bac < 0.08, 0, 1),
dui_ag = ifelse(bac < 0.15, 0, 1))
attach(base)
# Punto 1
## Histograma del BAC(running variable)
histogram_BAC = base %>%
ggplot(aes(x = bac)) +
geom_histogram(binwidth = 0.0001) +
geom_vline(xintercept = 0.08, color = "red") +
geom_vline(xintercept = 0.15, color = "blue") +
theme_light() +
xlab("BAC") +
ylab("Frequency") +
ggtitle("Histograma BAC")
histogram_BAC
# Punto 2
## Test de McCrary
### Para el valor de umbral bac = 0.08
test_0.08 = rddensity(bac, c = 0.08, vce = "plugin")
summary(test_0.08)
plot_mccrary_0.08 = rdplotdensity(test_0.08, bac)
### Para el valor de umbral bac = 0.15
test_0.15 = rddensity(bac, c = 0.15, vce = "plugin")
summary(test_0.15)
plot_mccrary_0.15 = rdplotdensity(test_0.15, bac)
# Nota agregar los titulos, xlabels y labels a cada grafica
# Punto 3
## Reproducción parcial de la Tabla 2 columnas (1)-(4), Panel (A)
### male vs bac
male_reg = rdrobust(male, bac, c = 0.08, kernel = "uniform", p = 1, h = 0.05, vce = "hc0")
summary(male_reg)
### white vs bac
white_reg = rdrobust(white, bac, c = 0.08, kernel = "uniform", p = 1, h = 0.05, vce = "hc0")
summary(white_reg)
### age vs bac
aged_reg = rdrobust(aged, bac, c = 0.08, kernel = "uniform", p = 1, h = 0.05, vce = "hc0")
summary(aged_reg)
### acc vs bac
acc_reg = rdrobust(acc, bac, c = 0.08, kernel = "uniform", p = 1, h = 0.05, vce = "hc0")
summary(acc_reg)
### means
mean(male)
mean(white)
mean(aged)
mean(acc)
# Punto 4
## Reproducción parcial de la Tabla 3, columna 1, Panel (A) y (B), (Estimación de interés)
## Se especifica una matriz de covariadas.
## Dicha matriz de covariadas va a ser empleada en los punto 4, 5, 6 y 7
covs = cbind.data.frame(male, white, year, aged)
### recidivism vs bac (bandwidth = 0.05)
recidivism_reg_0.05 = rdrobust(recidivism, bac, c = 0.08, kernel = "uniform",
p = 1, h = 0.05, vce = "hc0", covs = covs)
summary(recidivism_reg_0.05)
### recidivism vs bac (bandwidth = 0.025)
recidivism_reg_0.025 = rdrobust(recidivism, bac, c = 0.08, kernel = "uniform",
p = 1, h = 0.025, vce = "hc0", covs = covs)
summary(recidivism_reg_0.025)
### mean
mean(recidivism)
# Punto 5
## Muestre en una gráfica el outcome sobre la running variable, con cutoff a 0.08
## y soporte del BAC entre 0.03 y 0.20, con intervalos de confianza, kernel rectangular
### gráfica recidivism vs bac (sin intervalos de confianza)
recivitism_plot_not_interval = rdplot(recidivism, bac, x.lim = c(0.03, 0.2), y.lim = c(0, 0.25),
c = 0.08, kernel = "uniform", support = c(0.03, 0.2), p = 1, h = 0.05)
### gráfica recidivism vs bac (con intervalos de confianza)
recivitism_plot_with_interval = rdplot(recidivism, bac, x.lim = c(0.03, 0.2), y.lim = c(0, 0.25),
c = 0.08, kernel = "uniform", support = c(0.03, 0.2),
p = 1, shade = TRUE, ci = 95, h = 0.05, x.label = "bac",
y.label = "recidivism", title = "recidivism vs bac")
# Punto 6
## Calcule el pvalor del efecto del DUI usando inferencia randomizada
random_inf_treshold = rdrandinf(recidivism, bac, cutoff = 0.08, statistic = "diffmeans", p = 1, kernel = "uniform",
reps = 4000, seed = 1234);summary(random_inf_treshold)
random_inf_treshold = rdrandinf(general$estudio_ult_mes, general$puntaje_sisben_3, cutoff = 30.56,
statistic = "diffmeans", p = 1, kernel = "uniform",
reps = 4000, seed = 1234); summary(random_inf_treshold)
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1)
### Parámetros para el placebo1
placebo_cutoff1 = 10
bandwidth_placebo1 = 1
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1)
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.7, 0.8))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.6, 0.8))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.6, 0.8))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.6, 0.8),
x.lim = c(10, 20))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.6, 0.8),
x.lim = c(5, 20))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.6, 0.8),
x.lim = c(2.5, 25))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.65, 0.75),
x.lim = c(2.5, 25))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.65, 0.75),
x.lim = c(2.5, 25))
### Gráfica placebo1 sin intervalos de confianza
placebo_without = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.55, 0.85),
x.lim = c(2.5, 25))
### Estimando el modelo en el placebo1
placebo1_reg = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = placebo_cutoff1,
kernel = "uniform", vce = "hc0", p = 1, h = bandwidth_placebo1)
summary(placebo1_reg)
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1)
### Parámetros para el placebo2
placebo_cutoff2 = 65
bandwidth_placebo2 = 1
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1)
### Parámetros para el placebo2
placebo_cutoff2 = 45
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1)
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1, x.lim = c(43, 47))
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1, x.lim = c(43, 47),
y.lim = c(0.75, 1))
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1, x.lim = c(43, 47),
y.lim = c(0.7, 1))
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1, x.lim = c(43, 47),
y.lim = c(0.65, 1))
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1, x.lim = c(43, 47),
y.lim = c(0.6, 1))
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1, x.lim = c(43, 47),
y.lim = c(0.5, 1))
### Estimando el modelo en el placebo1
placebo2_reg = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = placebo_cutoff2,
kernel = "uniform", vce = "hc0", p = 1,
h = bandwidth_placebo2); summary(placebo2_reg) # El efecto no es significativo
source('~/Documents/GitHub/semestre5_git/proyecto_metodologia_2/trabajo_empirico/scripts/R/RDD_estimax_impact_FeA.R', echo=TRUE)
### Estimando el modelo en el placebo1
placebo2_reg = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = placebo_cutoff2,
kernel = "uniform", vce = "hc0", p = 1,
h = bandwidth_placebo2); summary(placebo2_reg) # El efecto no es significativo
####
### Script con estimación principal ###
####
# Bibliotecas generales de R
library(tidyverse)   # Conjunto de paquetes (contiene dplyr y ggplot2)
library(readxl)      # Importar bases de datos tipo excel
library(haven)       # Importar bases de datos tipo stata
# RD Packages (Conjunto de paquetes para realizar RDDs creados por Cattaneo)
library(rdrobust)
library(rddensity)
library(lpdensity)
library(rdlocrand)
setwd("~/Documents/GitHub/semestre5_git/proyecto_metodologia_2/trabajo_empirico/bases_de_datos/bases_de_datos_SISBEN")
####
### Script con estimación principal ###
####
# Bibliotecas generales de R
library(tidyverse)   # Conjunto de paquetes (contiene dplyr y ggplot2)
library(readxl)      # Importar bases de datos tipo excel
library(haven)       # Importar bases de datos tipo stata
# RD Packages (Conjunto de paquetes para realizar RDDs creados por Cattaneo)
library(rdrobust)
library(rddensity)
library(lpdensity)
library(rdlocrand)
setwd("~/Documents/GitHub/semestre5_git/proyecto_metodologia_2/trabajo_empirico/bases_de_datos/bases_de_datos_SISBEN")
#---- Base de Datos para estimación principal ----
sisben3 = read_dta("Sisben_III_PERS_DIC2016.dta")
View(sisben3)
# Base de datos modificada original (general)
general = sisben3 %>%
relocate(llave, hogar, orden, fex, .before = depto) %>%
relocate(zona, .before = area) %>%
relocate(corte, .before = puntaje_sisben_3) %>%
filter(per002 == 2 | per002 == 3) %>%                 # per002: Edad: 2: 6 a 11 años, 3: 12 a 17 años
mutate(asiste_centro_educativo = ifelse(per011 == 2, 0, 1),
sexo = ifelse(per001 == 2, 0, 1),
paga_alimentax = ifelse(per008 == 2, 0, 1),
embarazada = ifelse(per010 == 2, 0, 1),
percibe_ing = ifelse(per016 == 2, 0, 1),
estudio_ult_mes = ifelse(per014 == 4, 1, 0)
) %>%
select(llave, depto, puntaje_sisben_3, sexo, paga_alimentax, embarazada,
asiste_centro_educativo, percibe_ing, estudio_ult_mes)
histogram_puntaje_sisben = general %>%
ggplot(aes(x = puntaje_sisben_3)) +
geom_histogram(bins = 50) +
geom_vline(xintercept = 30.56, color = "red") +
theme_light() +
xlab("Puntaje del Sisbén ") +
ylab("Frequency") +
ggtitle("Histograma para el Puntaje del sisbén")
histogram_puntaje_sisben
### Para el valor de umbral puntaje del sisbén = 30.56
test_30.56 = rddensity(general$puntaje_sisben_3, c = 30.56, vce = "plugin")
summary(test_30.56)
plot_mccrary_30.56 = rdplotdensity(test_30.56, general$puntaje_sisben_3)
sexo_reg = rdrobust(general$sexo, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1); summary(sexo_reg)
sexo_reg = rdrobust(general$sexo, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1); summary(sexo_reg)
sexo_graph = rdplot(general$sexo, general$puntaje_sisben_3,
c = 30.56, kernel = "uniform", h = 3, p = 1,
support = c(28,35), x.lim = c(27, 34))
embarada_reg = rdrobust(general$embarazada, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1); summary(embarada_reg)
embarazada_graph = rdplot(general$embarazada, general$puntaje_sisben_3,
c = 30.56, kernel = "uniform", h = 3, p = 1,
support = c(28,35), x.lim = c(27, 34), y.lim = c(-0.1, 0.1))
percibe_ing_reg = rdrobust(general$percibe_ing, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1); summary(percibe_ing_reg)
percibe_ing_graph = rdplot(general$percibe_ing, general$puntaje_sisben_3,
c = 30.56, kernel = "uniform", h = 3, p = 1,
support = c(28,35), x.lim = c(27, 34), y.lim = c(-0.2, 0.3))
## Se especifica una matriz de covariadas: sexo, embarazada
covs = cbind.data.frame(general$sexo, general$embarazada, general$percibe_ing)
### estudio en el último mes vs puntaje del sisben (sin covariadas)
estudio_ult_mes_reg = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1); summary(asistencia_centro_educativo_reg)
### asistencia centro educativo vs puntaje del sisben (con covariadas)
estudio_ult_mes_reg_covs = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1, covs = covs); summary(asistencia_centro_educativo_reg_covs)
### gráfica asistencia centro educativo ultimo mes vs puntaje del sisben (sin intervalos de confianza)
main_reg_plot_not_interval = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = 30.56, kernel = "uniform", h = 3, p = 1,
support = c(28,35), x.lim = c(26,35), y.lim = c(0.8, 0.88))
mean_ult_mes = mean(general$estudio_ult_mes)
mean_ult_mes
### asistencia centro educativo vs puntaje del sisben (con covariadas)
estudio_ult_mes_reg_covs = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = 30.56,
kernel = "uniform", vce = "hc0", p = 1, h = 1, covs = covs); summary(asistencia_centro_educativo_reg_covs)
0.039/mean_ult_mes
random_inf_treshold = rdrandinf(general$estudio_ult_mes, general$puntaje_sisben_3, cutoff = 30.56,
statistic = "diffmeans", p = 1, kernel = "uniform",
reps = 4000, seed = 1234); summary(random_inf_treshold)
### Parámetros para el placebo1
placebo_cutoff1 = 15
bandwidth_placebo1 = 1
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.55, 0.85),
x.lim = c(2.5, 25))
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.55, 0.85),
x.lim = c(2.5, 25))
### Gráfica placebo1 sin intervalos de confianza
placebo1_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff1, kernel = "uniform", h = 3, p = 1, y.lim = c(0.55, 0.85),
x.lim = c(2.5, 25))
### Estimando el modelo en el placebo1
placebo1_reg = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = placebo_cutoff1,
kernel = "uniform", vce = "hc0", p = 1,
h = bandwidth_placebo1); summary(placebo1_reg) # El efecto no es significativo
### Parámetros para el placebo2
placebo_cutoff2 = 45
bandwidth_placebo2 = 1
### Gráfica placebo1 sin intervalos de confianza
placebo2_plot = rdplot(general$estudio_ult_mes, general$puntaje_sisben_3,
c = placebo_cutoff2, kernel = "uniform", h = 3, p = 1, x.lim = c(43, 47),
y.lim = c(0.5, 1))
### Estimando el modelo en el placebo1
placebo2_reg = rdrobust(general$estudio_ult_mes, general$puntaje_sisben_3, c = placebo_cutoff2,
kernel = "uniform", vce = "hc0", p = 1,
h = bandwidth_placebo2); summary(placebo2_reg) # El efecto no es significativo
mtcars
glimpse(mtcars)
reg = lm(mpg ~ disp, mtcars)
reg = lm(mpg ~ disp, mtcars)
residual(reg)
resid(reg)
residuals(reg)
length(residuals(reg))
length(mtcars$mpg)
